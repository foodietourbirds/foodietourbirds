function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,a){"function"==typeof define&&define.amd?define([],a):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=a():e.InstagramFeed=a()}(this,(function(){function e(e){return e.replace(/[&<>"'`=\/]/g,(function(e){return l[e]}))}function a(e){return void 0!==e.node.edge_media_to_caption.edges[0]&&void 0!==e.node.edge_media_to_caption.edges[0].node&&null!=e.node.edge_media_to_caption.edges[0].node.text?e.node.edge_media_to_caption.edges[0].node.text:null!=e.node.title&&0!=e.node.title.length?e.node.title:null!=e.node.accessibility_caption&&0!=e.node.accessibility_caption.length&&e.node.accessibility_caption}function t(e,a){var t=a||!1;if(!a&&0<e.cache_time){var i=localStorage.getItem(e.cache_time_key);null!==i&&parseInt(i)+6e4*e.cache_time>(new Date).getTime()&&(t=!0)}if(t){var r=localStorage.getItem(e.cache_data_key);if(null!==r)return JSON.parse(r)}return!1}function i(e,a){return"function"==typeof a?a(e):e}function r(t,r){var n,l="";if(t.styling?(n={profile_container:' style="text-align:center;"',profile_image:' style="border-radius:10em;width:15%;max-width:125px;min-width:50px;"',profile_name:' style="font-size:1.2em;"',profile_biography:' style="font-size:1em;"',gallery_image:' style="width:100%;"',gallery_image_link:' style="width:'+(100-2*t.margin*t.items_per_row)/t.items_per_row+"%; margin:"+t.margin+'%;position:relative; display: inline-block; height: 100%;"'},t.display_captions&&(l+="<style>                    a[data-caption]:hover::after {                        content: attr(data-caption);                        text-align: center;                        font-size: 0.8rem;                        color: black;                        position: absolute;                        left: 0;                        right: 0;                        bottom: 0;                        padding: 1%;                        max-height: 100%;                        overflow-y: auto;                        overflow-x: hidden;                        background-color: hsla(0, 100%, 100%, 0.8);                    }                </style>")):n={profile_container:"",profile_image:"",profile_name:"",profile_biography:"",gallery_image:"",gallery_image_link:""},t.display_profile&&"userid"!==t.type&&(l+='<div class="instagram_profile"'+n.profile_container+">",l+='<img class="instagram_profile_image" src="'+i(r.profile_pic_url,t.cdnUrlResolver)+'" alt="'+("tag"==t.type?r.name+" tag pic":r.username+" profile pic")+'"'+n.profile_image+(t.lazy_load?' loading="lazy"':"")+" />","tag"==t.type?l+='<p class="instagram_tag"'+n.profile_name+'><a href="https://www.instagram.com/explore/tags/'+t.tag+'/" rel="noopener" target="_blank">#'+t.tag+"</a></p>":"username"==t.type?(l+="<p class='instagram_username'"+n.profile_name+">@"+r.full_name+" (<a href='https://www.instagram.com/"+t.username+"/' rel='noopener' target='_blank'>@"+t.username+"</a>)</p>",t.display_biography&&(l+="<p class='instagram_biography'"+n.profile_biography+">"+r.biography+"</p>")):"location"==t.type&&(l+="<p class='instagram_location'"+n.profile_name+"><a href='https://www.instagram.com/explore/locations/"+t.location+"/' rel='noopener' target='_blank'>"+r.name+"</a></p>"),l+="</div>"),t.display_gallery)if(void 0!==r.is_private&&!0===r.is_private)l+='<p class="instagram_private"><strong>This profile is private</strong></p>';else{var s=void 0===o[t.image_size]?o[640]:o[t.image_size],c=(r.edge_owner_to_timeline_media||r.edge_hashtag_to_media||r.edge_location_to_media).edges,d=c.length>t.items?t.items:c.length;l+="<div class='instagram_gallery'>";for(var g=0;g<d;g++){var p,_,m="https://www.instagram.com/p/"+c[g].node.shortcode;switch(!1===(y=a(c[g]))&&(y=("userid"==t.type?"":t.id)+" image"),y=e(y),c[g].node.__typename){case"GraphSidecar":_="sidecar",p=c[g].node.thumbnail_resources[s].src;break;case"GraphVideo":_="video",p=c[g].node.thumbnail_src;break;default:_="image",p=c[g].node.thumbnail_resources[s].src}l+='<a href="'+m+'"'+(t.display_captions?' data-caption="'+y+'"':"")+' class="instagram-'+_+'" rel="noopener" target="_blank"'+n.gallery_image_link+">",l+="<img"+(t.lazy_load?' loading="lazy"':"")+' src="'+i(p,t.cdnUrlResolver)+'" alt="'+y+'"'+n.gallery_image+" />",l+="</a>"}l+="</div>"}if(t.display_igtv&&void 0!==r.edge_felix_video_timeline){var u=r.edge_felix_video_timeline.edges;if(d=u.length>t.items?t.items:u.length,0<u.length){for(l+='<div class="instagram_igtv">',g=0;g<d;g++){var y;m="https://www.instagram.com/p/"+u[g].node.shortcode,!1===(y=a(u[g]))&&(y=("userid"==t.type?"":t.id)+" image"),y=e(y),l+='<a href="'+m+'"'+(t.display_captions?' data-caption="'+y+'"':"")+' rel="noopener" target="_blank"'+n.gallery_image_link+">",l+="<img"+(t.lazy_load?' loading="lazy"':"")+' src="'+i(u[g].node.thumbnail_src)+'" alt="'+y+'"'+n.gallery_image+" />",l+="</a>"}l+="</div>"}}t.container.innerHTML=l}var n={host:"https://www.instagram.com/",username:"",tag:"",user_id:"",location:"",container:"",display_profile:!0,display_biography:!0,display_gallery:!0,display_captions:!1,display_igtv:!1,max_tries:8,callback:null,cdnUrlResolver:null,styling:!0,items:8,items_per_row:4,margin:.5,image_size:640,lazy_load:!1,cache_time:360,on_error:console.error},o={150:0,240:1,320:2,480:3,640:4},l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return"function"!=typeof Object.assign&&(Object.assign=function(e){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");e=Object(e);for(var a,t=1;t<arguments.length;t++)if(null!=(a=arguments[t]))for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i]);return e}),function(e){this.valid=!1;var a=Object.assign({},n);return""==(a=Object.assign(a,e)).username&&""==a.tag&&""==a.user_id&&""==a.location?(a.on_error("Instagram Feed: Error, no username, tag or user_id defined.",1),!1):(void 0!==e.display_profile&&e.display_profile&&""!=a.user_id&&console.warn("Instagram Feed: 'display_profile' is not available using 'user_id' (GraphQL API)"),void 0!==e.display_biography&&e.display_biography&&(""!=a.tag||""!=a.location||""!=a.user_id)&&console.warn("Instagram Feed: 'display_biography' is not available unless you are loading an user ('username' parameter)"),void 0!==a.get_data&&console.warn("Instagram Feed: options.get_data is deprecated, options.callback is always called if defined"),null==a.callback&&""==a.container?(a.on_error("Instagram Feed: Error, neither container found nor callback defined.",2),!1):null!=a.cdnUrlResolver&&"function"!=typeof a.cdnUrlResolver?(a.on_error("Instagram Feed: options.cdnUrlResolver must be a function or null."),!1):(""==a.username?""==a.tag?""==a.location?(a.type="userid",a.id=a.user_id):(a.type="location",a.id=a.location):(a.type="tag",a.id=a.tag):(a.type="username",a.id=a.username),a.cache_data_key="instagramFeed_"+a.type+"_"+a.id,a.cache_time_key=a.cache_data_key+"_time",function(e,a){var i=t(e,!1);if(!1!==i)a(i);else{var r;switch(e.type){case"username":r=e.host+e.id+"/";break;case"tag":r=e.host+"explore/tags/"+e.id+"/";break;case"location":r=e.host+"explore/locations/"+e.id+"/";break;case"userid":r=e.host+'graphql/query/?query_id=17888483320059182&variables={"id":"'+e.id+'","first":'+e.items+',"after":null}'}!function e(a,t,i,r,n,o){var l;n&&o&&(l="https://images"+~~(3333*Math.random())+"-focus-opensocial.googleusercontent.com/gadgets/proxy?container=none&url="+a);var s=new XMLHttpRequest;s.onload=function(){4===s.readyState&&200===s.status&&(data=function(e,a){switch(e){case"username":case"tag":case"location":try{a=a.split("window._sharedData = ")[1].split("<\/script>")[0]}catch(e){return!1}return void 0!==(a=(a=JSON.parse(a.substr(0,a.length-1))).entry_data.ProfilePage||a.entry_data.TagPage||a.entry_data.LocationsPage)&&(a[0].graphql.user||a[0].graphql.hashtag||a[0].graphql.location);case"userid":return void 0!==a.data.user&&a.data.user}}(t,s.responseText),!1===data?r(!1):r(data))},s.onerror=function(l){1<i?(console.warn("Instagram Feed: Request failed, "+(i-1)+" tries left. Retrying..."),e(a,t,i-1,r,n,!o)):r(!1,l)},s.open("GET",l||a,!0),s.send()}(r,e.type,e.max_tries,(function(i,r){!1===i?void 0===r?e.on_error("Instagram Feed: It looks like the profile you are trying to fetch is age restricted. See https://github.com/jsanahuja/InstagramFeed/issues/26",3):!1===(i=t(e,!0))?e.on_error("Instagram Feed: Unable to fetch the given user/tag. Instagram responded with the status code: "+r.status,5):a(i):(function(e,a){var t=localStorage.getItem(e.cache_time_key);0!=e.cache_time&&(null===t||parseInt(t)+6e4*e.cache_time>(new Date).getTime())&&(localStorage.setItem(e.cache_data_key,JSON.stringify(a)),localStorage.setItem(e.cache_time_key,(new Date).getTime()))}(e,i),a(i))}),e.host===n.host&&"userid"!=e.type,!1)}}(a,(function(e){""!=a.container&&r(a,e),null!=a.callback&&a.callback(e)})),void(this.valid=!0)))}}));